<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS Management - GreenShop Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #166e22;
            --primary-dark: #0e5016;
            --primary-light: #2a8c36;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --border-color: rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            --box-shadow-hover: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-gray);
        }


        .content-card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            padding: 2rem;
            margin-bottom: 2rem;
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .cms-option-card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            height: 100%;
        }

        .cms-option-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-hover);
            border-color: var(--primary-color);
        }

        .cms-option-card.active {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(22, 110, 34, 0.1), rgba(42, 140, 54, 0.05));
        }

        .option-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 2rem;
            color: white;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            border: none;
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-hover);
        }

        .table {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        .table thead th {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            border: none;
            font-weight: 600;
            padding: 1rem;
        }

        .table tbody td {
            padding: 1rem;
            vertical-align: middle;
            border-color: var(--border-color);
        }

        .action-btn {
            padding: 0.5rem;
            border-radius: 8px;
            border: none;
            margin: 0 0.25rem;
            transition: var(--transition);
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: var(--box-shadow-hover);
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid var(--border-color);
            padding: 0.75rem 1rem;
            transition: var(--transition);
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(22, 110, 34, 0.25);
        }

        .image-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .image-upload-area:hover {
            border-color: var(--primary-color);
            background-color: rgba(22, 110, 34, 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .image-preview {
            position: relative;
            display: inline-block;
            margin: 0.5rem;
        }

        .preview-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 10px;
            border: 2px solid var(--border-color);
        }

        .remove-image {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 12px;
            cursor: pointer;
        }

        .carousel-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .type-option {
            flex: 1;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .type-option:hover {
            border-color: var(--primary-color);
        }

        .type-option.active {
            border-color: var(--primary-color);
            background-color: rgba(22, 110, 34, 0.1);
        }

        .fade-in {
            opacity: 0;
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner-border {
            color: var(--primary-color);
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 500;
            font-size: 0.875rem;
        }

        .redirect-info {
            background: rgba(22, 110, 34, 0.1);
            border-radius: 8px;
            padding: 0.75rem;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- CMS Options -->
        <div class="row mb-4" id="cmsOptions">
            <div class="col-md-6">
                <div class="cms-option-card" data-option="footer" onclick="selectOption('footer')">
                    <div class="option-icon">
                        <i class="bi bi-layout-text-window-reverse"></i>
                    </div>
                    <h4>Footer Management</h4>
                    <p class="text-muted mb-0">Manage footer content including contact information and social links</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="cms-option-card" data-option="carousel" onclick="selectOption('carousel')">
                    <div class="option-icon">
                        <i class="bi bi-images"></i>
                    </div>
                    <h4>Carousel Management</h4>
                    <p class="text-muted mb-0">Manage homepage carousel slides with images and content</p>
                </div>
            </div>
        </div>

        <!-- Footer Management Section -->
        <div class="content-card" id="footerSection" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4 class="mb-0">Footer Settings</h4>
                <button class="btn btn-primary" onclick="showFooterForm()">
                    <i class="bi bi-plus-circle me-2"></i>Update Footer
                </button>
            </div>

            <div class="loading-spinner" id="footerLoading">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Loading footer data...</p>
            </div>

            <div class="table-responsive">
                <table class="table table-hover" id="footerTable">
                    <thead>
                        <tr>
                            <th>Setting</th>
                            <th>Value</th>
                            <th>Last Updated</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="footerTableBody">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Carousel Management Section -->
        <div class="content-card" id="carouselSection" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4 class="mb-0">Carousel Slides</h4>
                <button class="btn btn-primary" onclick="showCarouselForm()">
                    <i class="bi bi-plus-circle me-2"></i>Add New Slide
                </button>
            </div>

            <div class="loading-spinner" id="carouselLoading">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Loading carousel data...</p>
            </div>

            <div class="table-responsive">
                <table class="table table-hover" id="carouselTable">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Title</th>
                            <th>Subtitle</th>
                            <th>Type</th>
                            <th>Redirect</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="carouselTableBody">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Footer Form Modal -->
    <div class="modal fade" id="footerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Update Footer Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="footerForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="email" class="form-control" id="footerEmail" placeholder="Email">
                                    <label for="footerEmail">Email Address</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="tel" class="form-control" id="footerContact" placeholder="Contact">
                                    <label for="footerContact">Contact Number</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-floating mb-3">
                            <input type="url" class="form-control" id="footerInstagram" placeholder="Instagram URL">
                            <label for="footerInstagram">Instagram URL</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveFooterSettings()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Carousel Form Modal -->
    <div class="modal fade" id="carouselModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="carouselModalTitle">Add New Carousel Slide</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="carouselForm">
                        <!-- Carousel Type Selection -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Carousel Type</label>
                            <div class="carousel-type-selector">
                                <div class="type-option active" data-type="non-link" onclick="selectCarouselType('non-link')">
                                    <i class="bi bi-image fs-2 text-primary mb-2"></i>
                                    <h6>Non-Link Carousel</h6>
                                    <p class="text-muted mb-0">Display only image, title and subtitle</p>
                                </div>
                                <div class="type-option" data-type="link" onclick="selectCarouselType('link')">
                                    <i class="bi bi-link-45deg fs-2 text-primary mb-2"></i>
                                    <h6>Link Carousel</h6>
                                    <p class="text-muted mb-0">Include redirect functionality</p>
                                </div>
                            </div>
                            <input type="hidden" id="carouselType" value="non-link">
                        </div>

                        <!-- Image Upload -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Carousel Image</label>
                            <div class="image-upload-area" id="carouselImageUpload">
                                <i class="bi bi-cloud-upload upload-icon"></i>
                                <h5>Upload Carousel Image</h5>
                                <p class="text-muted">Drag and drop or click to select image (Recommended: 1920x600px)</p>
                                <input type="file" id="carouselImageInput" accept="image/*" style="display: none;">
                            </div>
                            <div id="carouselImagePreview" class="mt-3"></div>
                        </div>

                        <!-- Content Fields -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="carouselTitle" placeholder="Title">
                                    <label for="carouselTitle">Slide Title</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="carouselSubtitle" placeholder="Subtitle">
                                    <label for="carouselSubtitle">Slide Subtitle</label>
                                </div>
                            </div>
                        </div>

                        <!-- Redirect Options (for link type) -->
                        <div id="redirectOptions" style="display: none;">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Redirect Options</label>
                                <div class="form-floating mb-3">
                                    <select class="form-select" id="redirectType">
                                        <option value="">Select Redirect Type</option>
                                        <option value="category">Category</option>
                                        <option value="product">Product</option>
                                        <option value="custom">Custom URL</option>
                                    </select>
                                    <label for="redirectType">Redirect Type</label>
                                </div>

                                <div id="categorySelect" style="display: none;">
                                    <div class="form-floating mb-3">
                                        <select class="form-select" id="redirectCategory">
                                            <option value="">Select Category</option>
                                            <option value="vegetables">Vegetables</option>
                                            <option value="fruits">Fruits</option>
                                            <option value="leafy-greens">Leafy Greens</option>
                                            <option value="root-vegetables">Root Vegetables</option>
                                            <option value="cruciferous">Cruciferous</option>
                                            <option value="herbs">Herbs</option>
                                        </select>
                                        <label for="redirectCategory">Category</label>
                                    </div>
                                </div>

                                <div id="productSelect" style="display: none;">
                                    <div class="form-floating mb-3">
                                        <select class="form-select" id="redirectProduct">
                                            <option value="">Select Product</option>
                                            <option value="P001">Organic Tomatoes</option>
                                            <option value="P002">Fresh Spinach</option>
                                            <option value="P003">Organic Carrots</option>
                                            <option value="P004">Bell Peppers</option>
                                            <option value="P005">Broccoli</option>
                                        </select>
                                        <label for="redirectProduct">Product</label>
                                    </div>
                                </div>

                                <div id="customUrlInput" style="display: none;">
                                    <div class="form-floating mb-3">
                                        <input type="url" class="form-control" id="redirectUrl" placeholder="Custom URL">
                                        <label for="redirectUrl">Custom URL</label>
                                    </div>
                                </div>

                                <div id="redirectPreview" class="redirect-info" style="display: none;">
                                    <strong>Redirect URL:</strong> <span id="redirectUrlPreview"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Status -->
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="carouselActive" checked>
                            <label class="form-check-label" for="carouselActive">
                                Active (Show on website)
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveCarouselSlide()">Save Slide</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script>
        // Sample data
        const footerData = {
            email: 'contact@greenshop.com',
            contact: '+91 9876543210',
            instagram: 'https://instagram.com/greenshop'
        };

        const carouselData = [
            {
                id: 1,
                image: '/placeholder.svg?height=300&width=800&text=Slide1',
                title: 'Fresh Organic Vegetables',
                subtitle: 'Farm to table freshness guaranteed',
                type: 'link',
                redirectType: 'category',
                redirectValue: 'vegetables',
                active: true
            },
            {
                id: 2,
                image: '/placeholder.svg?height=300&width=800&text=Slide2',
                title: 'Premium Quality Fruits',
                subtitle: 'Handpicked for perfection',
                type: 'non-link',
                active: true
            },
            {
                id: 3,
                image: '/placeholder.svg?height=300&width=800&text=Slide3',
                title: 'Special Discount Offer',
                subtitle: 'Up to 30% off on selected items',
                type: 'link',
                redirectType: 'custom',
                redirectValue: 'https://greenshop.com/offers',
                active: false
            }
        ];

        let currentEditingId = null;
        let selectedCarouselImage = null;

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize animations
            setTimeout(() => {
                document.querySelectorAll('.content-card, .cms-option-card').forEach((el, index) => {
                    el.style.animationDelay = `${index * 0.1}s`;
                    el.classList.add('fade-in');
                });
            }, 100);

            setupImageUpload();
            setupCarouselTypeSelection();
            setupRedirectOptions();
        });

        function selectOption(option) {
            // Remove active class from all options
            document.querySelectorAll('.cms-option-card').forEach(card => {
                card.classList.remove('active');
            });

            // Add active class to selected option
            document.querySelector(`[data-option="${option}"]`).classList.add('active');

            // Hide all sections
            document.getElementById('footerSection').style.display = 'none';
            document.getElementById('carouselSection').style.display = 'none';

            // Show selected section
            if (option === 'footer') {
                document.getElementById('footerSection').style.display = 'block';
                loadFooterData();
            } else if (option === 'carousel') {
                document.getElementById('carouselSection').style.display = 'block';
                loadCarouselData();
            }
        }

        function loadFooterData() {
            const loading = document.getElementById('footerLoading');
            const tableBody = document.getElementById('footerTableBody');
            
            loading.style.display = 'block';
            tableBody.innerHTML = '';

            setTimeout(() => {
                const footerRows = [
                    {
                        setting: 'Email Address',
                        value: footerData.email,
                        lastUpdated: '2024-01-15 10:30 AM'
                    },
                    {
                        setting: 'Contact Number',
                        value: footerData.contact,
                        lastUpdated: '2024-01-15 10:30 AM'
                    },
                    {
                        setting: 'Instagram URL',
                        value: footerData.instagram,
                        lastUpdated: '2024-01-15 10:30 AM'
                    }
                ];

                footerRows.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${row.setting}</strong></td>
                        <td>${row.value}</td>
                        <td>${row.lastUpdated}</td>
                        <td>
                            <button class="btn btn-sm btn-primary action-btn" onclick="showFooterForm()" title="Edit">
                                <i class="bi bi-pencil"></i>
                            </button>
                        </td>
                    `;
                    tableBody.appendChild(tr);
                });

                loading.style.display = 'none';
            }, 1000);
        }

        function loadCarouselData() {
            const loading = document.getElementById('carouselLoading');
            const tableBody = document.getElementById('carouselTableBody');
            
            loading.style.display = 'block';
            tableBody.innerHTML = '';

            setTimeout(() => {
                carouselData.forEach(slide => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>
                            <img src="${slide.image}" alt="${slide.title}" 
                                 style="width: 80px; height: 50px; object-fit: cover; border-radius: 8px;">
                        </td>
                        <td><strong>${slide.title}</strong></td>
                        <td>${slide.subtitle}</td>
                        <td>
                            <span class="badge ${slide.type === 'link' ? 'bg-primary' : 'bg-secondary'}">
                                ${slide.type === 'link' ? 'Link' : 'Non-Link'}
                            </span>
                        </td>
                        <td>
                            ${slide.type === 'link' ? getRedirectDisplay(slide) : '<span class="text-muted">N/A</span>'}
                        </td>
                        <td>
                            <span class="status-badge ${slide.active ? 'bg-success' : 'bg-danger'} text-white">
                                ${slide.active ? 'Active' : 'Inactive'}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-primary action-btn" onclick="editCarouselSlide(${slide.id})" title="Edit">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-danger action-btn" onclick="deleteCarouselSlide(${slide.id})" title="Delete">
                                <i class="bi bi-trash"></i>
                            </button>
                            <button class="btn btn-sm btn-info action-btn" onclick="toggleSlideStatus(${slide.id})" title="Toggle Status">
                                <i class="bi bi-toggle-${slide.active ? 'on' : 'off'}"></i>
                            </button>
                        </td>
                    `;
                    tableBody.appendChild(tr);
                });

                loading.style.display = 'none';
            }, 1000);
        }

        function getRedirectDisplay(slide) {
            if (slide.redirectType === 'category') {
                return `<span class="badge bg-info">Category: ${slide.redirectValue}</span>`;
            } else if (slide.redirectType === 'product') {
                return `<span class="badge bg-warning">Product: ${slide.redirectValue}</span>`;
            } else if (slide.redirectType === 'custom') {
                return `<span class="badge bg-dark">Custom URL</span>`;
            }
            return '<span class="text-muted">N/A</span>';
        }

        function showFooterForm() {
            // Populate form with current data
            document.getElementById('footerEmail').value = footerData.email;
            document.getElementById('footerContact').value = footerData.contact;
            document.getElementById('footerInstagram').value = footerData.instagram;

            const modal = new bootstrap.Modal(document.getElementById('footerModal'));
            modal.show();
        }

        function saveFooterSettings() {
            const email = document.getElementById('footerEmail').value;
            const contact = document.getElementById('footerContact').value;
            const instagram = document.getElementById('footerInstagram').value;

            // Update data
            footerData.email = email;
            footerData.contact = contact;
            footerData.instagram = instagram;

            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('footerModal')).hide();

            // Reload data
            loadFooterData();

            showToast('Footer settings updated successfully!', 'success');
        }

        function showCarouselForm(slideId = null) {
            currentEditingId = slideId;
            const modal = new bootstrap.Modal(document.getElementById('carouselModal'));
            const modalTitle = document.getElementById('carouselModalTitle');

            if (slideId) {
                modalTitle.textContent = 'Edit Carousel Slide';
                const slide = carouselData.find(s => s.id === slideId);
                if (slide) {
                    populateCarouselForm(slide);
                }
            } else {
                modalTitle.textContent = 'Add New Carousel Slide';
                resetCarouselForm();
            }

            modal.show();
        }

        function populateCarouselForm(slide) {
            document.getElementById('carouselTitle').value = slide.title;
            document.getElementById('carouselSubtitle').value = slide.subtitle;
            document.getElementById('carouselActive').checked = slide.active;
            
            // Set carousel type
            selectCarouselType(slide.type);
            
            if (slide.type === 'link') {
                document.getElementById('redirectType').value = slide.redirectType;
                handleRedirectTypeChange();
                
                if (slide.redirectType === 'category') {
                    document.getElementById('redirectCategory').value = slide.redirectValue;
                } else if (slide.redirectType === 'product') {
                    document.getElementById('redirectProduct').value = slide.redirectValue;
                } else if (slide.redirectType === 'custom') {
                    document.getElementById('redirectUrl').value = slide.redirectValue;
                }
            }

            // Show image preview
            if (slide.image) {
                const preview = document.getElementById('carouselImagePreview');
                preview.innerHTML = `
                    <div class="image-preview">
                        <img src="${slide.image}" alt="Carousel Image" class="preview-image">
                        <button type="button" class="remove-image" onclick="removeCarouselImage()">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>
                `;
            }
        }

        function resetCarouselForm() {
            document.getElementById('carouselForm').reset();
            document.getElementById('carouselType').value = 'non-link';
            document.getElementById('carouselImagePreview').innerHTML = '';
            selectedCarouselImage = null;
            selectCarouselType('non-link');
        }

        function setupImageUpload() {
            const uploadArea = document.getElementById('carouselImageUpload');
            const fileInput = document.getElementById('carouselImageInput');

            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleImageDrop);
            fileInput.addEventListener('change', handleImageSelect);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.style.borderColor = 'var(--primary-color)';
            e.currentTarget.style.backgroundColor = 'rgba(22, 110, 34, 0.1)';
        }

        function handleImageDrop(e) {
            e.preventDefault();
            e.currentTarget.style.borderColor = 'var(--border-color)';
            e.currentTarget.style.backgroundColor = '';
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleCarouselImage(files[0]);
            }
        }

        function handleImageSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                handleCarouselImage(files[0]);
            }
        }

        function handleCarouselImage(file) {
            if (!file.type.startsWith('image/')) {
                showToast('Please select a valid image file', 'error');
                return;
            }

            selectedCarouselImage = file;
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('carouselImagePreview');
                preview.innerHTML = `
                    <div class="image-preview">
                        <img src="${e.target.result}" alt="Carousel Image" class="preview-image">
                        <button type="button" class="remove-image" onclick="removeCarouselImage()">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>
                `;
            };
            reader.readAsDataURL(file);
        }

        function removeCarouselImage() {
            selectedCarouselImage = null;
            document.getElementById('carouselImagePreview').innerHTML = '';
            document.getElementById('carouselImageInput').value = '';
        }

        function setupCarouselTypeSelection() {
            const typeOptions = document.querySelectorAll('.type-option');
            typeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    selectCarouselType(type);
                });
            });
        }

        function selectCarouselType(type) {
            // Update UI
            document.querySelectorAll('.type-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            
            // Update hidden input
            document.getElementById('carouselType').value = type;
            
            // Show/hide redirect options
            const redirectOptions = document.getElementById('redirectOptions');
            if (type === 'link') {
                redirectOptions.style.display = 'block';
            } else {
                redirectOptions.style.display = 'none';
            }
        }

        function setupRedirectOptions() {
            const redirectType = document.getElementById('redirectType');
            redirectType.addEventListener('change', handleRedirectTypeChange);
        }

        function handleRedirectTypeChange() {
            const redirectType = document.getElementById('redirectType').value;
            
            // Hide all options
            document.getElementById('categorySelect').style.display = 'none';
            document.getElementById('productSelect').style.display = 'none';
            document.getElementById('customUrlInput').style.display = 'none';
            document.getElementById('redirectPreview').style.display = 'none';
            
            // Show relevant option
            if (redirectType === 'category') {
                document.getElementById('categorySelect').style.display = 'block';
            } else if (redirectType === 'product') {
                document.getElementById('productSelect').style.display = 'block';
            } else if (redirectType === 'custom') {
                document.getElementById('customUrlInput').style.display = 'block';
            }
        }

        function saveCarouselSlide() {
            const title = document.getElementById('carouselTitle').value;
            const subtitle = document.getElementById('carouselSubtitle').value;
            const type = document.getElementById('carouselType').value;
            const active = document.getElementById('carouselActive').checked;

            if (!title || !subtitle) {
                showToast('Please fill in all required fields', 'error');
                return;
            }

            if (!selectedCarouselImage && !currentEditingId) {
                showToast('Please select an image', 'error');
                return;
            }

            const slideData = {
                title,
                subtitle,
                type,
                active,
                image: selectedCarouselImage ? URL.createObjectURL(selectedCarouselImage) : null
            };

            if (type === 'link') {
                const redirectType = document.getElementById('redirectType').value;
                if (!redirectType) {
                    showToast('Please select a redirect type', 'error');
                    return;
                }

                slideData.redirectType = redirectType;
                
                if (redirectType === 'category') {
                    slideData.redirectValue = document.getElementById('redirectCategory').value;
                } else if (redirectType === 'product') {
                    slideData.redirectValue = document.getElementById('redirectProduct').value;
                } else if (redirectType === 'custom') {
                    slideData.redirectValue = document.getElementById('redirectUrl').value;
                }

                if (!slideData.redirectValue) {
                    showToast('Please provide redirect information', 'error');
                    return;
                }
            }

            if (currentEditingId) {
                // Update existing slide
                const index = carouselData.findIndex(s => s.id === currentEditingId);
                if (index > -1) {
                    carouselData[index] = { ...carouselData[index], ...slideData };
                }
                showToast('Carousel slide updated successfully!', 'success');
            } else {
                // Add new slide
                slideData.id = carouselData.length + 1;
                carouselData.push(slideData);
                showToast('Carousel slide added successfully!', 'success');
            }

            // Close modal and reload data
            bootstrap.Modal.getInstance(document.getElementById('carouselModal')).hide();
            loadCarouselData();
        }

        function editCarouselSlide(id) {
            showCarouselForm(id);
        }

        function deleteCarouselSlide(id) {
            if (confirm('Are you sure you want to delete this carousel slide?')) {
                const index = carouselData.findIndex(s => s.id === id);
                if (index > -1) {
                    carouselData.splice(index, 1);
                    loadCarouselData();
                    showToast('Carousel slide deleted successfully!', 'success');
                }
            }
        }

        function toggleSlideStatus(id) {
            const slide = carouselData.find(s => s.id === id);
            if (slide) {
                slide.active = !slide.active;
                loadCarouselData();
                showToast(`Slide ${slide.active ? 'activated' : 'deactivated'} successfully!`, 'success');
            }
        }

        function refreshData() {
            const activeOption = document.querySelector('.cms-option-card.active');
            if (activeOption) {
                const option = activeOption.getAttribute('data-option');
                if (option === 'footer') {
                    loadFooterData();
                } else if (option === 'carousel') {
                    loadCarouselData();
                }
            }
            showToast('Data refreshed successfully!', 'info');
        }

        function showToast(message, type) {
            const toastContainer = document.createElement('div');
            toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
            toastContainer.style.zIndex = '9999';
            
            const toast = document.createElement('div');
            toast.className = `toast align-items-center text-white bg-${type === 'error' ? 'danger' : type} border-0`;
            toast.setAttribute('role', 'alert');
            
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            document.body.appendChild(toastContainer);
            
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
            
            toast.addEventListener('hidden.bs.toast', () => {
                document.body.removeChild(toastContainer);
            });
        }
    </script>
</body>
</html> 